# MLMedicine
Применение машинного обучения для решения медицинских задач
# Проекты по анализу медицинских данных
Данный репозиторий содержит 4 самостоятельных проекта, в которых демонстрируются различные подходы и инструменты машинного обучения для анализа медицинских данных. В частности, рассмотрены задачи классификации медицинских изображений, сегментации кожных образований и прогнозирования заболевания диабетом на основе клинических показателей.

---

## Содержание

1. [Описание проектов](#описание-проектов)
2. [Требования к окружению](#требования-к-окружению)
3. [Используемые инструменты](#используемые-инструменты)
4. [Как запустить](#как-запустить)

---

## Описание проектов

### 1. [Классификация медицинских изображений](Pneumonia)
- **Задача:** Обнаружение пневмонии по рентгеновским снимкам грудной клетки.
- **Данные:** [Chest X-Ray Images (Pneumonia)](https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia).
- **Краткое описание:**
    - Выполнена загрузка и предобработка рентгеновских снимков (очистка, приведение к единым размерам, нормализация).
    - Использованы сверточные нейронные сети (CNN) для обучения модели классификации.
    - Проведена оценка качества с использованием метрик точности, полноты и F1-меры.

### 2. [Сегментация медицинских изображений](Segmentation)
- **Задача:** Сегментация кожных образований на дерматоскопических изображениях.
- **Данные:** [ISIC 2018 Challenge - Task 1: Lesion Segmentation](https://www.kaggle.com/datasets/tschandl/isic2018-challenge-task1-data-segmentation).
- **Краткое описание:**
    - Предварительная обработка изображений: аугментация, приведение к нужным размерам, нормализация.
    - Реализована архитектура U-Net (или аналогичные сегментационные сети) для точного определения границ кожных образований.
    - Результаты оценивались при помощи метрик IoU (Intersection over Union), Dice coefficient и др.

### 3. [Прогнозирование заболеваний диабета](Predict_Diabetes)
- **Задача:** Классификация наличия или отсутствия диабета на основе клинических данных.
- **Данные:** [Pima Indians Diabetes Database](https://www.kaggle.com/datasets/uciml/pima-indians-diabetes-database/data).
- **Краткое описание:**
    - Проведена первичная очистка данных, замена некорректных значений, а также заполнение пропусков.
    - Применены методы балансировки классов (SMOTE) и нормализации признаков (StandardScaler).
    - Обучение и оценка классификаторов (RandomForest, Logistic Regression и др.) с анализом метрик (Accuracy, Precision, Recall, ROC-AUC).
    - Использованы SHAP-значения и анализ важности признаков для интерпретации работы модели.

### 4. [**Классификация текстовых отрывков**](StyleTextRNN)
- **Задача:** Обучить и использовать LSTM и GRU сети для генерации текста в стиле писателей:
    * Чехова А.П.
    * Маяковского В.В.
    * Достоевского Ф.М.

- Подбор архитектур RNN (LSTM, GRU) и их гиперпараметров для анализа естественных текстов (Чехов, Достоевский, Маяковский и пр.).  
- Оценка качества (Accuracy, Loss) обучения на различных наборах текстов и конфигурациях сетей.


### 5. [**Прогноз диабета по клинико-демографическим данным**](DiabetesRNN)
- **Задача:** С использованием LSTM и GRU моделей произвести прогноз состояния здоровья пациента - наличие у него сахарного диабета
- **Данные:** [Diabetes Health Indicators Dataset](https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset)
- Предобработка табличных признаков (One-Hot, стандартизация, SMOTE).  
- Построение двунаправленных LSTM/GRU для мультиклассовой классификации (нет диабета, преддиабет, диабет).  
- Эксперименты по подбору числа временных единиц, dropout, размера batch, оценки на отложенной выборке.

### 6. [Сверточные нейронные сети, MedMNIST, VGG](vgg_experiments)
- **Задача:** Обучить и использовать модели VGG16 и VGG19 для задач классификации по 6 заданным классам. 
- **Данные:** [Медицинские изображения (формат MNIST)](https://www.kaggle.com/datasets/gennadiimanzhos/medical-mnist-train-test-val)
- Исследовать влияние конфигурации сверточных слоев, функций активации, глубины и операций подвыборки на эффективность моделей семейства VGG в задаче многоклассовой классификации медицинских изображений (6 классов, 64×64 пикселя).

#### Структура:
- Реализация гибкой функции `build_custom_cnn()` для генерации VGG-подобных моделей.
- Сравнительные эксперименты с конфигурациями: `light`, `moderate`, `heavy`.
- Вариации: `ReLU` vs `LeakyReLU`, отключение MaxPooling, уменьшенные фильтры, глубокие слои.
- Аугментация и визуализация accuracy/loss по архитектурам.

####  Результаты:
- Максимальная точность достигнута на конфигурации `heavy (ReLU)` — 99.83%.
- Выявлено, что использование глубокой и широкой сверточной структуры с регуляризацией и подвыборкой значительно повышает устойчивость моделей.
- Добавлены графики, таблицы конфигураций и формальный аналитический вывод.


### 7. [Сверточные нейронные сети, Covid19 Death Prediction, VGG](covid_prediction)
- **Данные:** [COVID-19 Dataset by Meir Nizri](https://www.kaggle.com/datasets/meirnizri/covid19-dataset)

#### Цель:
Решить задачу бинарной классификации: предсказание факта смерти пациента по структурированным данным COVID-19 (датасет Kaggle).

#### Этапы:
- Предобработка: создание бинарной метки `fact_death`, стандартизация, устранение пропусков.
- Аугментация выборки с помощью SMOTE для борьбы с дисбалансом классов.
- Построение простых табличных моделей (MLP) с вариацией активаций, глубины, оптимизаторов.
- Автоматизация запуска экспериментов и логирование метрик.

#### Результаты:
- Лучшая точность достигнута на модели `[64, 32]`, `ReLU`, `Adam`, `lr=1e-3` — 92.66%.
- Обнаружена некорректная функция потерь из-за бинарной метки в диапазоне {1,2}; даны рекомендации по её исправлению.
- Проанализированы чувствительность модели к архитектурным и обучающим параметрам.




---

## Требования к окружению

- Python 3.7+
- Jupyter Notebook или JupyterLab (при желании)
- Библиотеки:
    - NumPy
    - Pandas
    - Matplotlib / Seaborn
    - scikit-learn
    - TensorFlow / PyTorch (в зависимости от реализации нейронных сетей)
    - imbalanced-learn (для SMOTE)
    - SHAP (для интерпретации моделей)

---

## Используемые инструменты

- **scikit-learn** — машинное обучение и классические алгоритмы классификации, регрессии, кластеризации.
- **TensorFlow/PyTorch** — фреймворки для глубокого обучения (использовались в задачах классификации и сегментации изображений).
- **NumPy, Pandas** — базовые библиотеки для научных вычислений и работы с данными.
- **Matplotlib, Seaborn** — инструменты визуализации данных.
- **imbalanced-learn** — методы балансировки данных (SMOTE, ADASYN и т. д.).
- **SHAP** — инструмент для интерпретации моделей и оценки вклада признаков.

---

## Как запустить

1. **Клонировать репозиторий**:
   ```bash
   git clone https://github.com/Soundflog/MLMedicine.git
   ```
2. Установить необходимые библиотеки (например, через pip или conda):
    ```bash
   pip install -r requirements.txt
   ```
При отсутствии файла requirements.txt установите библиотеки вручную по списку выше.

3. Открыть соответствующий проект (например, classification, segmentation или diabetes_prediction) и запустить Jupyter Notebook:
    ```bash
   jupyter notebook
   ```
4. Запустить ноутбук с шагами обработки данных, обучения и оценки модели.

